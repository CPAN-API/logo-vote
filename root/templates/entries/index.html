<h2>Vote for your favorites!</h2>
<div class="help">

  <p>This is the voting system for the MetaCPAN Logo Contest. To find out more
  about the contest, visit it's <a href="http://contest.metacpan.org">main
  page</a>. All Logo submissions we received are summariesed on this page, but
  also available with more details on our
  <a href="http://entries.contest.metacpan.org/">Logo Entries Blog</a>.</p>

  <p>If you're here to cast your vote, please read on.</p>

  <h2>How to Vote</h2>
  <div class="rules">
    <ul id="rules-list">
      <li>
        Be a MetaCPAN contributor before $cutoff_date
        <% IF c.user_exists %><span class="mark">&#x2713;</span><% END %>
      </li>
      <li>
        <a href="<% c.uri_for('/login') %>">Log in</a>
        <% IF c.user_exists %><span class="mark">&#x2713;</span><% END %>
      </li>
      <li>Rank the list of logos according to your preferences and click
      the <strong>Vote</strong> button at the end of the page.
        <ul>
          <li>A preference is specified as a positive integer</li>
          <li>A smaller number indicates a higher preference</li>
          <li>You may
            <ul>
              <li>give two logos the same number to indicate you're indifferent
              about them</li>
              <li>use non-consecutive numbers - only the order of candidates
              matter, not the numeric value of your ranking</li>
              <li>keep candidates unranked to indicate that you prefer all
              ranked logos over unranked ones and that you're indifferent about
              all unranked candidates</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </div>

  <h2>Voting Rules</h2>
  <div class="rules">
    <p>TODO</p>
  </div>

</div>

<script type="text/javascript">
$(function () {
  $('input.title-vote, input.vote').change(function () {
    var match = $(this).attr('name').match(/^([\w-]+)[.](\d+)[.]score$/);
    if (!match) { return false; }

    switch(match[1]) {
      case "votes":
        $("#not-votes\\." + match[2] + "\\.score").val( $(this).val() );
        break;
      case "not-votes":
        $("#votes\\." + match[2] + "\\.score").val( $(this).val() );
        break;
    }

    return true;
  }).numeric({
    decimal: false,
    negative: false
  });
});
</script>

<% FOREACH entry IN entries %>
<% SET id = loop.index %>
  <h2>
    <% IF c.user_exists %>
    <input type="text" class="title-vote" id="not-votes.<% id %>.score"
           name="not-votes.<% id %>.score" value="" />
    <% END %>
    <% entry.title %>
    <div style="clear: both"></div>
  </h2>
  <div class="entry">
    <ul>
      <li><a href="<% entry.link %>">View Blog Post</a></li>
    </ul>
    <div class="images">
      <% FOREACH image IN entry.images %>
        <img src="<% image.src %>" height="<% image.height %>" width="<% image.width %>" border="0" />
      <% END %>
    </div>
  </div>
<% END %>

<% IF c.user_exists %>
<h2>Cast your vote!</h2>
  <div class="entry votepoll">

    <form method="post" action="<% c.uri_for('/vote/') %>" id="vote">
      <% FOREACH entry IN entries %>
      <% SET id = loop.index %>
      <div class="vote-entry">
        <input type="hidden" name="votes.<% id %>.title" value="<% entry.title %>" />
        <input type="hidden" name="votes.<% id %>.name" value="<% entry.link %>" />
        <input type="text" class="vote" id="votes.<% id %>.score" name="votes.<% id %>.score" value="" />
        <label for="votes.<% id %>.score"><% entry.title %></label>
      </div>
      <% END %>

      <input type="submit" value="Vote" />
    </form>
  </div>
<% END %>
